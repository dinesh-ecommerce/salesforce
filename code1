Adding code1 from dev branch
